from __future__ import print_function, absolute_import
import os.path as osp
import shutil

import torch

from .osutils import mkdir_if_missing


def save_checkpoint(state, is_best, fpath='checkpoint.pth.tar'):
  mkdir_if_missing(osp.dirname(fpath))
  torch.save(state, fpath)
  if is_best:
    shutil.copy(fpath, osp.join(osp.dirname(fpath), 'model_best.pth.tar'))


def load_checkpoint(fpath):
  if osp.isfile(fpath):
    checkpoint = torch.load(fpath)
    print("=> Loaded checkpoint '{}'".format(fpath))
    return checkpoint
  else:
    raise ValueError("=> No checkpoint found at '{}'".format(fpath))

